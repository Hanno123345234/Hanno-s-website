<!doctype html>
<html lang="de">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="theme-color" content="#0f1220" />
    <link rel="manifest" href="/manifest.webmanifest" />
    <title>Among Us Modus</title>
    <link rel="stylesheet" href="styles.css" />
  </head>
  <body>
    <main class="app">
      <section id="amongHome" class="card active">
        <div class="top-tools">
          <a id="amongBackToModes" href="/" class="mini-link">← Zur Auswahl</a>
          <div class="lang-inline">
            <label for="amongLangSelect">Sprache</label>
            <select id="amongLangSelect" aria-label="Sprache auswählen">
              <option value="de">Deutsch</option>
            </select>
          </div>
        </div>
        <p class="subtitle">Gemacht von Hanno</p>
        <h1>Among Us Modus</h1>
        <p class="subtitle">Raum erstellen oder beitreten</p>

        <label for="amongNameInput">Dein Name</label>
        <input id="amongNameInput" maxlength="24" placeholder="z. B. Hanno" />

        <div class="score-board">
          <span class="score-chip">Queue Casual: <strong id="queueCasual">0</strong></span>
          <span class="score-chip">Queue Ranked: <strong id="queueRanked">0</strong></span>
        </div>

        <div class="stack">
          <button id="amongQuickCasualBtn">Quick Play Casual</button>
          <button id="amongQuickRankedBtn">Quick Play Ranked</button>
          <button id="amongLeaveQueueBtn">Queue verlassen</button>
        </div>

        <button id="amongCreateBtn" class="primary">Raum erstellen</button>

        <div class="join-box">
          <label for="amongCodeInput">Raumcode</label>
          <input id="amongCodeInput" maxlength="5" placeholder="ABCDE" />
          <button id="amongJoinBtn">Raum beitreten</button>
        </div>

        <div class="join-box">
          <label for="amongPartyInput">Party-Code</label>
          <input id="amongPartyInput" maxlength="6" placeholder="ABC123" />
          <button id="amongJoinPartyBtn">Mit Party-Code beitreten</button>
        </div>

        <p id="amongError" class="error"></p>
      </section>

      <section id="amongRoom" class="card">
        <div class="room-header">
          <button id="amongBackBtn" class="back-btn">← Zurück</button>
          <h2>Raum <span id="amongRoomCode">-----</span></h2>
        </div>

        <div class="score-board">
          <span class="score-chip">Party: <strong id="amongPartyCode">------</strong></span>
          <span class="score-chip">Mode: <strong id="amongQueueMode">casual</strong></span>
          <span class="score-chip">Voice: <strong id="amongVoice">-</strong></span>
        </div>

        <p id="amongState" class="subtitle">Lobby</p>
        <p id="amongRole" class="room-notice hidden"></p>

        <div class="score-board">
          <span class="score-chip">Besprechung: <strong id="amongMeeting">-</strong></span>
          <span class="score-chip">Leiche: <strong id="amongBody">-</strong></span>
        </div>

        <div id="amongHostControls" class="stack hidden">
          <button id="amongStartBtn" class="primary">Spiel starten</button>
        </div>

        <div id="amongActions" class="stack hidden">
          <button id="amongTaskBtn">Aufgabe erledigen</button>
          <button id="amongMeetingBtn">Notfall-Besprechung</button>
          <button id="amongReportBtn">Leiche melden</button>
          <button id="amongFixSabotageBtn">Sabotage fixen</button>
        </div>

        <div id="amongMovement" class="hidden">
          <h3>Map Bewegung</h3>
          <div id="amongMoveTargets" class="vote-buttons"></div>
        </div>

        <div id="amongKillBox" class="hidden">
          <h3>Hochstapler-Aktionen</h3>
          <div id="amongKillTargets" class="vote-buttons"></div>
          <button id="amongSabotageLightsBtn">Sabotage: Lights</button>
          <button id="amongSabotageReactorBtn">Sabotage: Reactor</button>
        </div>

        <div id="amongRoleActions" class="hidden">
          <h3>Spezialrolle</h3>
          <div id="amongRoleActionTargets" class="vote-buttons"></div>
          <button id="amongHackerScanBtn" class="hidden">Hacker Scan</button>
          <button id="amongTricksterBtn" class="hidden">Trickster Decoy</button>
        </div>

        <div id="amongVoteBox" class="hidden">
          <h3>Besprechungs-Abstimmung</h3>
          <p id="amongVoteInfo" class="subtitle"></p>
          <div id="amongVoteTargets" class="vote-buttons"></div>
        </div>

        <div class="player-list-wrap">
          <h3>Spieler</h3>
          <ul id="amongPlayers" class="player-list"></ul>
        </div>

        <div class="player-list-wrap">
          <h3>Ereignisse</h3>
          <ul id="amongLogs" class="player-list"></ul>
        </div>

        <div class="player-list-wrap">
          <h3>Highlights</h3>
          <ul id="amongHighlights" class="player-list"></ul>
        </div>

        <div class="player-list-wrap">
          <h3>Chat</h3>
          <ul id="amongChatList" class="player-list"></ul>
          <div class="join-box">
            <input id="amongChatInput" maxlength="220" placeholder="Nachricht schreiben…" />
            <button id="amongChatSendBtn">Senden</button>
          </div>
        </div>

        <div class="player-list-wrap">
          <h3>Voice</h3>
          <p id="amongVoiceStatus" class="subtitle">Voice aus</p>
          <div class="stack">
            <button id="amongVoiceStartBtn">Voice starten</button>
            <button id="amongVoiceMuteBtn">Mikro stumm</button>
            <button id="amongVoiceLeaveBtn">Voice verlassen</button>
          </div>
          <div id="amongVoiceAudioMount" class="hidden"></div>
        </div>

        <button id="amongRematchBtn" class="primary hidden">Rematch bereit</button>
      </section>
    </main>

    <script src="/socket.io/socket.io.js"></script>
    <script>
      (function setupAmongLanguageMenu() {
        const key = "app_lang_v1";
        const select = document.getElementById("amongLangSelect");
        const backLink = document.getElementById("amongBackToModes");
        if (!select || !backLink) {
          return;
        }

        function getLang() {
          return "de";
        }

        function applyLang(lang) {
          window.localStorage.setItem(key, lang);
          document.documentElement.lang = lang;
          select.value = lang;
          backLink.href = `/?lang=${encodeURIComponent(lang)}`;
          const url = new URL(window.location.href);
          url.searchParams.set("lang", lang);
          window.history.replaceState(null, "", url.toString());
        }

        select.addEventListener("change", () => {
          applyLang("de");
        });

        applyLang(getLang());
      })();
    </script>
    <script src="pwa.js"></script>
    <script src="amongus.js"></script>
  </body>
  </html>
