<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Among Us Mode</title>
    <link rel="stylesheet" href="styles.css" />
  </head>
  <body>
    <main class="app">
      <section id="amongHome" class="card active">
        <div class="top-tools">
          <a id="amongBackToModes" href="/" class="mini-link">← Back to modes</a>
          <div class="lang-inline">
            <label for="amongLangSelect">Language</label>
            <select id="amongLangSelect" aria-label="Select language">
              <option value="en">English</option>
            </select>
          </div>
        </div>
        <h1>Among Us Mode</h1>
        <p class="subtitle">Create a room or join one</p>

        <label for="amongNameInput">Your name</label>
        <input id="amongNameInput" maxlength="24" placeholder="e.g. Hanno" />

        <button id="amongCreateBtn" class="primary">Create room</button>

        <div class="join-box">
          <label for="amongCodeInput">Room code</label>
          <input id="amongCodeInput" maxlength="5" placeholder="ABCDE" />
          <button id="amongJoinBtn">Join room</button>
        </div>

        <p id="amongError" class="error"></p>
      </section>

      <section id="amongRoom" class="card">
        <div class="room-header">
          <button id="amongBackBtn" class="back-btn">← Back</button>
          <h2>Room <span id="amongRoomCode">-----</span></h2>
        </div>

        <p id="amongState" class="subtitle">Lobby</p>
        <p id="amongRole" class="room-notice hidden"></p>

        <div class="score-board">
          <span class="score-chip">Meeting: <strong id="amongMeeting">-</strong></span>
          <span class="score-chip">Body: <strong id="amongBody">-</strong></span>
        </div>

        <div id="amongHostControls" class="stack hidden">
          <button id="amongStartBtn" class="primary">Start game</button>
        </div>

        <div id="amongActions" class="stack hidden">
          <button id="amongTaskBtn">Complete task</button>
          <button id="amongMeetingBtn">Emergency Meeting</button>
          <button id="amongReportBtn">Report body</button>
        </div>

        <div id="amongKillBox" class="hidden">
          <h3>Imposter actions</h3>
          <div id="amongKillTargets" class="vote-buttons"></div>
        </div>

        <div id="amongVoteBox" class="hidden">
          <h3>Meeting Vote</h3>
          <p id="amongVoteInfo" class="subtitle"></p>
          <div id="amongVoteTargets" class="vote-buttons"></div>
        </div>

        <div class="player-list-wrap">
          <h3>Players</h3>
          <ul id="amongPlayers" class="player-list"></ul>
        </div>

        <div class="player-list-wrap">
          <h3>Logs</h3>
          <ul id="amongLogs" class="player-list"></ul>
        </div>
      </section>
    </main>

    <script src="/socket.io/socket.io.js"></script>
    <script>
      (function setupAmongLanguageMenu() {
        const key = "app_lang_v1";
        const select = document.getElementById("amongLangSelect");
        const backLink = document.getElementById("amongBackToModes");
        if (!select || !backLink) {
          return;
        }

        function getLang() {
          return "en";
        }

        function applyLang(lang) {
          window.localStorage.setItem(key, lang);
          document.documentElement.lang = lang;
          select.value = lang;
          backLink.href = `/?lang=${encodeURIComponent(lang)}`;
          const url = new URL(window.location.href);
          url.searchParams.set("lang", lang);
          window.history.replaceState(null, "", url.toString());
        }

        select.addEventListener("change", () => {
          applyLang("en");
        });

        applyLang(getLang());
      })();
    </script>
    <script src="amongus.js"></script>
  </body>
  </html>
